<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–∏–Ω–∞–º—ñ—á–Ω–∞ —Ç–∞–±–ª–∏—Ü—è –∑ API</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>

<h2>–¢–∞–±–ª–∏—Ü—è –∑ –¥–∞–Ω–∏–º–∏</h2>

<button id="load-data">–û–Ω–æ–≤–∏—Ç–∏ —Ç–∞–±–ª–∏—Ü—é</button>

<table id="data-table" border="1">
    <thead>
        <tr>
            <th>–Ü–º'—è <button id="sort-name">üîΩ</button></th>
            <th>–§—Ä–∞–∫—Ü—ñ—è <button id="sort-affiliation">üîΩ</button></th>
        </tr>
    </thead>
    <tbody>
        <!-- –î–∞–Ω—ñ –±—É–¥—É—Ç—å –¥–æ–¥–∞–≤–∞—Ç–∏—Å—è —Å—é–¥–∏ -->
    </tbody>
</table>

<script>
// –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
$(document).ready(function() {
    // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö
    function loadData() {
        $.ajax({
            url: 'http://lab.vntu.org/api-server/lab7.php',
            type: 'GET',
            dataType: 'json',
            success: function(data) {
                console.log(data);  // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞: –≤–∏–≤–æ–¥–∏–º–æ –¥–∞–Ω—ñ —É –∫–æ–Ω—Å–æ–ª—å
                if (Array.isArray(data)) {
                    let tableContent = '';
                    data.forEach(function(record) {
                        tableContent += `<tr>
                                            <td>${record.name}</td>
                                            <td>${record.affiliation}</td>
                                          </tr>`;
                    });
                    $('#data-table tbody').html(tableContent);  // –í—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–∏—Ö —É —Ç–∞–±–ª–∏—Ü—é
                } else {
                    console.error('–ù–µ–≤—ñ—Ä–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–∏—Ö');
                }
            },
            error: function(xhr, status, error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø–∏—Ç—É:', error);
            }
        });
    }

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –∫–Ω–æ–ø–∫–∏
    $('#load-data').click(function() {
        loadData();
    });

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
    loadData();
    
    // –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∑–∞ —ñ–º–µ–Ω–µ–º
    $('#sort-name').click(function() {
        let rows = $('#data-table tbody tr').get();
        rows.sort(function(a, b) {
            let nameA = $(a).find('td').eq(0).text().toUpperCase();
            let nameB = $(b).find('td').eq(0).text().toUpperCase();
            if (nameA < nameB) return -1;
            if (nameA > nameB) return 1;
            return 0;
        });
        $.each(rows, function(index, row) {
            $('#data-table tbody').append(row);
        });
    });

    // –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∑–∞ —Ñ—Ä–∞–∫—Ü—ñ—î—é
    $('#sort-affiliation').click(function() {
        let rows = $('#data-table tbody tr').get();
        rows.sort(function(a, b) {
            let affiliationA = $(a).find('td').eq(1).text().toUpperCase();
            let affiliationB = $(b).find('td').eq(1).text().toUpperCase();
            if (affiliationA < affiliationB) return -1;
            if (affiliationA > affiliationB) return 1;
            return 0;
        });
        $.each(rows, function(index, row) {
            $('#data-table tbody').append(row);
        });
    });
});
</script>

</body>
</html>
